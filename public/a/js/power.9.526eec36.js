webpackJsonp([9],{1066:function(e,t,r){"use strict";function n(e){return(0,i.post)(o+"changeMenu",JSON.stringify(e))}function a(e){return(0,i.post)(c+"menu/"+e)}function s(e){return(0,i.post)(c+"list/"+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.updatePower=n,t.getMenus=a,t.getPowers=s;var i=r(131),o=i.HOST_API+"facilitator/",c=i.HOST_API+"menu/";!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(o,"facilitator","/Users/zhaoguoping/work/integrationPay_web/backstage/src/libs/api/power.js"),__REACT_HOT_LOADER__.register(c,"menu","/Users/zhaoguoping/work/integrationPay_web/backstage/src/libs/api/power.js"),__REACT_HOT_LOADER__.register(n,"updatePower","/Users/zhaoguoping/work/integrationPay_web/backstage/src/libs/api/power.js"),__REACT_HOT_LOADER__.register(a,"getMenus","/Users/zhaoguoping/work/integrationPay_web/backstage/src/libs/api/power.js"),__REACT_HOT_LOADER__.register(s,"getPowers","/Users/zhaoguoping/work/integrationPay_web/backstage/src/libs/api/power.js"))}()},1067:function(e,t){},973:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,s){try{var i=t[a](s),o=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(o).then(function(e){n("next",e)},function(e){n("throw",e)});e(o)}return n("next")})}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=r(130),l=n(u),f=r(939),p=n(f),h=r(947),_=n(h),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r(159),r(940),r(948);var v=r(0),w=n(v),g=r(5),y=n(g),b=r(34),O=r(1066);r(1067);var A=function(e){function t(){var e,r,n,a;i(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return r=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),n.state={menus:[]},n.save=function(){var e;return(e=n).__save__REACT_HOT_LOADER__.apply(e,arguments)},n.renderPower=function(){var e;return(e=n).__renderPower__REACT_HOT_LOADER__.apply(e,arguments)},a=r,o(n,a)}return c(t,e),m(t,[{key:"__renderPower__REACT_HOT_LOADER__",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.state.menus;return e.map(function(e,a){var i=e.name,o=e.children,c=e.hasAccess,u=e.isOpen,l=e.fatherId;return o?w.default.createElement("div",{className:(0,y.default)("power-item",{show:u}),key:a},w.default.createElement("div",{className:(0,y.default)("parent-item",{open:u})},w.default.createElement(_.default,{checked:c,indeterminate:o.some(function(e){return e.hasAccess}),onChange:function(e){var i,c=e.target.checked;t.setState({menus:(0,b.write)(n,[""+r+a+".hasAccess",""+r+a+".children"],(i={},s(i,""+r+a+".hasAccess",c),s(i,""+r+a+".children",o.map(function(e){return d({},e,{hasAccess:c})})),i))})}}),i,w.default.createElement("span",{className:(0,y.default)("icon",{"icon-zhankai":!u,"icon-shouqi":u}),onClick:function(){t.setState({powers:(0,b.write)(n,""+r+a+".isOpen",!u)})}})),t.renderPower(o,""+r+a+".children.")):w.default.createElement("div",{className:(0,y.default)("power-item",{show:u}),key:a},w.default.createElement(_.default,{checked:c,onChange:function(e){var i=e.target.checked;if(l){var o=r.replace(".children.","");if(i){var c=(0,b.write)(n,""+r+a+".hasAccess",i);(0,b.read)(c,o+".children").every(function(e){return e.hasAccess})?t.setState({menus:(0,b.write)(n,o+".hasAccess",i)}):t.setState({menus:c})}else{var u;t.setState({menus:(0,b.write)(n,[""+r+a+".hasAccess",o+".hasAccess"],(u={},s(u,""+r+a+".hasAccess",i),s(u,o+".hasAccess",i),u))})}}else t.setState({menus:(0,b.write)(n,""+r+a+".hasAccess",i)})}}),i)})}},{key:"__save__REACT_HOT_LOADER__",value:function(){var e=this.state.menus,t=this.props.match.params;(0,O.updatePower)({id:t.id,menuIds:this.getIds(e)}).then(function(e){e.eCode?p.default.error("保存失败，请重试~"):p.default.success("保存成功~")})}},{key:"render",value:function(){var e=this.state.menus;return w.default.createElement("div",{className:"system-power"},w.default.createElement("div",{className:"head"},w.default.createElement("p",null,"用户名：",this.props.match.params.userName||"--"),w.default.createElement("p",null,"姓名：","null"===this.props.match.params.name?"--":this.props.match.params.name),w.default.createElement("p",null,"备注：","null"===this.props.match.params.remark?"--":this.props.match.params.remark)),w.default.createElement("div",{className:"content"},this.renderPower(e),w.default.createElement(l.default,{onClick:this.save},"保存")))}},{key:"getIds",value:function(e){var t=this;return e.reduce(function(e,r){var n=r.id,a=r.hasAccess,s=r.children;return a?s?e.concat(n).concat(t.getIds(s)):e.concat(n):e},[])}},{key:"getMenus",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match,e.next=3,(0,O.getMenus)(t.params.id);case 3:r=e.sent,n=r.data,this.setState({menus:this.menuToTree(this.menuToObj(n))});case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"menuToObj",value:function(e){var t={},r=!0,n=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var o=s.value;1===o.level&&(t=(0,b.write)(t,""+o.id,o)),2===o.level&&(t=(0,b.write)(t,o.fatherId+".children."+o.id+"k",o))}}catch(e){n=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw a}}return t}},{key:"menuToTree",value:function(e){var t=this;return Object.values(e).map(function(e){var r=e.children,n=e.id,a=e.hasAccess,s=e.fatherId,i=e.name;return r?{id:n,name:i,hasAccess:a,children:t.menuToTree(r)}:d({id:n,name:i,hasAccess:a},s?{fatherId:s}:{})})}},{key:"componentDidMount",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.getMenus();case 1:case"end":return e.stop()}},e,this)}));return e}()}]),t}(v.PureComponent);t.default=A;!function(){"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(A,"SystemPower","/Users/zhaoguoping/work/integrationPay_web/backstage/src/app/system/system-user/components/power/index.js")}()}});